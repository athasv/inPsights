# <img src="https://git.rwth-aachen.de/luechow-group/inPsights/raw/54c596a07173a76677e6c8e55a4dd7ff42ff3ae8/src/GUI/inPsights.png" alt="inPsights" width="272" height="100"> [![master status](https://git.rwth-aachen.de/luechow-group/inPsights/badges/master/pipeline.svg)](https://git.rwth-aachen.de/luechow-group/inPsights/commits/master)
#### Chemical insights from |Ψ|² analysis

inPsights is a open-source software package for the probability density analysis (PDA) of the total electronic wave function Ψ.
It analyzes maxima data generated by the open-source quantum Monte Carlo software package [Amolqc](https://github.com/luechow-group/Amolqc).

## Installation
### Installing required packages
To install inPsights, Git, CMake, the GNU Compiler Collection (gcc) and the Eigen3 library must be installed. This is most easily achieved by employing a packet manager.

#### MacOS
Make sure that the Xcode Command Line Tools are installed already with: 
```bash
xcode-select --install
```

To install the required packages on MacOS, the [homebrew package manager](https://brew.sh) can be used. 
It can be downloaded and installed from the command line as follows:
```bash
/usr/bin/ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"
```
To download the packages with homebrew` execute the following command in the terminal:
```bash
brew update
brew upgrade
brew install -y git cmake gcc lapack eigen boost qt
```

#### Ubuntu
To install the required packages on Ubuntu, the package manager `aptitude` can be used.
To download the required packages with aptitude` execute the following command in the terminal:
```bash
sudo apt-get -y install \
    build-essential git cmake \
    gcc g++ gfortran \
    libgomp1 libblas-dev liblapack-dev libeigen3-dev libboost-all-dev \ 
    qtbase5-dev qt3d5-dev 

```
Alternatively, Qt5 can be downloaded from the [Qt webpage](https://www.qt.io/download). 
During the installation make sure to install Qt for the `x86_64` architecture and select `sources`, `Qt3D`, and additionally `QtCharts` (which will be required in future versions as well).

#### Cloning inPsights
Make sure you are registered for the GitLab service of https://git.rwth-aachen.de and that you have an SSH-Key for your account on the local machine you are using.
Furthermore, make sure you have permission to all repositiories by asking the git-administrator of the luechow-group.

```bash
git clone git@git.rwth-aachen.de:luechow-group/inpsights.git
```
and check out the branch of interest e.g.`git checkout develop`. Next, execute
```bash
git submodule update --init --recursive
```
to initialize all the submodules.

The next time you checkout a branch e.g.
```bash
git checkout develop
```
the submodules do not need to be initialized again afterwards. Thus
```bash
git submodule update --recursive
```
should be sufficient.

### Setting environment variables

#### Amolqc
The path to `Amolqc` *must* be exported as an environment variable e.g.

```bash
export AMOLQC=/Users/michaelheuer/Projects/inPsights/src/AmolqcInterface/Amolqc
```
to allow for interfacing `Amolqc` in the `AmolqcInterface` module.

#### Compilers
Environment variables for the different compilers and the libraries must be specified e.g. 

for the `GNU Compiler Collection`
```bash
export CC=/usr/local/bin/gcc-8
export CXX=/usr/local/bin/g++-8
export FC=/usr/local/bin/gfortran-8
export CMAKE_PREFIX_PATH=/usr/local/Cellar/qt/5.11.2
```
or `Intel Parallel Studio XE`
```bash
export FC=/opt/intel/bin/ifort
export CC=/opt/intel/bin/icc
export CXX=/opt/intel/bin/icpc
export INTELROOT=/opt/intel/
export MKLROOT=/opt/intel/mkl
export CMAKE_PREFIX_PATH=/usr/local/Cellar/qt/5.11.2
```
Otherwise the default compilers are used.

If Qt was download from the webpage, the following environment variable must be exported:
```bash
export Qt5_DIR=/home/<username>/Qt/5.XX.X/gcc_64
```

## Running inPsights from the Command-Line

Create a build directory e.g.
```bash
mkdir cmake-build-release
cd cmake-build-release
```
and perform an out-of-source release build:

```bash
cmake ..
make
```
To build the GUI, set the following cmake variables:
```bash
cmake .. -DBUILD_GUI=ON -DBUILD_EIGEN=OFF
```

To build only a specific target write
```bash
make TargetName
```
instead. 

