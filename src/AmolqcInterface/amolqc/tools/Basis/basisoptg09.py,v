head	1.1;
access;
symbols;
locks
	luechow:1.1; strict;
comment	@# @;


1.1
date	2011.11.24.12.54.39;	author luechow;	state Exp;
branches;
next	;


desc
@basis set optimization with gaussian 09
@


1.1
log
@Initial revision
@
text
@#!/usr/bin/env python
import sys,os 
import subprocess
from numpy import *
from scipy.optimize import fmin

def writeBasisFromVector(handle,a):
    handle.write('H 0\n')
    for ai in a:
        handle.write(' S   1 1.00\n')
        handle.write('    '+str(ai)+'  1.0000D+00\n')
    handle.write(' ****\n')
    handle.write("\n")

def writeGaussianHeader(handle):
    handle.write("#p gfinput HF/gen int=nobasistransform punch=mo scf=tight\n")
    handle.write("\n")
    handle.write(" primitive S basis for optimization\n")
    handle.write("\n")
    handle.write("0 2\n")
    handle.write("H  0.0   0.0   0.0\n")
    handle.write("\n")

def runGaussianAndGetEnergy(baseName):
    """ run g09 with baseName.com and return first SCF energy
    This file may contain a local basis set (@@file.gbs)""" 
    cmd = ['g09',baseName+'.com']
    subprocess.check_call(cmd)
    logfile = open(baseName+'.log',"r")
    while True:
        line = logfile.readline()
        if 'SCF Done' in line:
            words = line.split()
            energy = words[4]
            break
    return energy

class scfEnergy:
    def __init__(self,bfList,amolqcBasisSet,baseName):
        self.bfList = bfList
        self.baseName = baseName
        self.abs= amolqcBasisSet
        self.
    def __call__(self,x):
        """call Gaussian and return SCF energy"""
        
        return runGaussianAndGetEnergy(self.baseName)
    def value(self,x):
        return runGaussianAndGetEnergy(self.baseName)



##a0 = [5.0, 3.0, 1.0, 0.5]

##scf = scfEnergy(1)
##aopt = fmin(scf,a0,xtol=1e-3)

a = array([  1.77075498e+03,   4.19147678e+02,   1.17080703e+02,   3.79293095e+01,
   1.40054671e+01,   5.79315302e+00,   2.63808528e+00,   1.29981272e+00,
   6.81008528e-01,   3.72877194e-01,   2.09692206e-01,   1.19031976e-01,
   6.70303638e-02,   3.68016915e-02])
e1 = runGaussianAndGetEnergy(a)
print "energy=",e1


@
